sudo: true
language: python
python:
  - "3.6"
  - "nightly"

env:
  - MOZ_HEADLESS=1

addons:
  firefox: latest

install:
  - pip install -r requirements/dev.txt

before_install:
  - wget https://github.com/mozilla/geckodriver/releases/download/v0.24.0/geckodriver-v0.24.0-linux64.tar.gz
  - mkdir geckodriver
  - tar -xzf geckodriver-v0.24.0-linux64.tar.gz -C geckodriver
  - sudo chmod +x $PWD/geckodriver/geckodriver
  - export PATH=$PATH:$PWD/geckodriver

script:
  - nosetests --with-cov --cov-config .coveragerc --cov ci_demo tests/

after_success:
  - codecov
jobs:
  include:
    - stage: Deploy
      script: skip
      deploy:
        provider: heroku
        api_key:
          secure: tzF44VHEWoxHsYWw9gwjElD/kVneK98EyknmpdMPcv3yVT+33OnSn7QOIokWevY9tcPY5WYFy4B2TcriWzfyoE8HUIXZU8iTnkq5W15CqHfC+wk/QrntGZ1a9m5+fysE1aON/vEpGJ+UdBXIi+5kM+mWLtTFx7sdYek7epLGb/rIepbp81gdP+/YOE2mNd23xbMLvqMKDDG/auQWi4oSwJYupjSSDXWt57ZjA5/bkLhuk27PRAF+xIKVxxkUf4gV+qU7VJ2iHEXgwINGVtk6P1Td1zWswpSJ+8lXo5fvGa4HVZbFuVUOUN+3OIXRyWpi78wa33MUYzsjyr0wuBSPEdIQrEu60QRYhAMNBq3TryRumtZZvrmiujjJ9503kK3CA08vxTCAxqwiQN9f41mhBwdZR4M5JJpgzbUeNTxV+fCKJfq/l78SO4GMDQh4GYtLzatpny/2FIpg1KwF2HwCBamyYDDW9A23oNPuzqu1YgibEP8aJnYgiqNyuA8yP1f9IyS5VzkquvaKLcXODB6QnQ/WeNGgIDx58D82ToXJWo8QgeHRroU+4LqtUb+zbdK31h6DIp5r8azyUtD5qBdU5mB5B7Xt9BQfB9sBOt/2bkRkjzRGJkCAzEvn58Y8LpJxiA7jIDclgeKodS3kuGipfDZ1Vlr/SAr5JJhtVSQ/jtg=
          app: ci-workshop-rom
        on:
          repo: rohubert/ci_workshop
