sudo: true
language: python
python:
  - "3.6"
  - "nightly"

env:
  - MOZ_HEADLESS=1

addons:
  firefox: latest

install:
  - pip install -r requirements/dev.txt

before_install:
  - wget https://github.com/mozilla/geckodriver/releases/download/v0.24.0/geckodriver-v0.24.0-linux64.tar.gz
  - mkdir geckodriver
  - tar -xzf geckodriver-v0.24.0-linux64.tar.gz -C geckodriver
  - sudo chmod +x $PWD/geckodriver/geckodriver
  - export PATH=$PATH:$PWD/geckodriver

script:
  - nosetests --with-cov --cov-config .coveragerc --cov ci_demo tests/

after_success:
  - codecov
jobs:
  include:
    - stage: Deploy
      script: skip
      deploy:
        provider: heroku
        api_key:
          secure: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA+rbnWi7jpKGP2++XNxgV HcInf7Il0/h2O8JZZ0IBY2OhErUCr7oZcct2cvWVGXTlnsOz0CjdEsKK2CHgcTzZ L0FN0Mf6sYIAXbORGvc2e96vrOCL2iZ2pzR9SE6Ahp4hQ7de1ABXB87N2k78uTRO Cnrile20QIbCW6Qv3Mq347PGM9ggiu2CD/G5cWQsCidRSvmbTj12V3bvIcV7JYdF E9G+QACkqzT8Zj2K50+fEJM0Ug5pM5c/YDWO6EyD2WbjeDxJIKSAMG1lwnrET2rZ NByWM+rINPpeEoPOiNWDb2pT2cRmKQLqlttrznaCmp8dp1B2jcAv0TgTY0C50bYp 9KMjMTkUJNNOhE8RlCjw6oKva4fsSNErhxl+2tK7jB7BODIdxN56CQ+AQ2+RCZF/ H+AO6Hb5CEvc0RPJMawWuEOWG0IcIwDt9OUXml4nakRKIhbBn9pbNBm70ggnrpwH UYD/tiMD9eGyuYE8AAkzzQs69nW8UWYix9hCKa+psTG4gb93MajRoUMCJGhyYaBB Orpd0csJrCSCLNk88tEUUlYpFIGfQZV0LbihrFU8lzXw2d0b2q0kUAG0psayjzvq wiRUqsVYcegGA+AiSJXSIPkWvKYHI4jMaKTB3yyrJBLIQpO6bcWCqGeIgFCTKWk8 +cl2NL/PWxs8LaEdb4Vl8xECAwEAAQ==        
          app: ci-workshop-rom
        on:
          repo: rohubert/ci_workshop
